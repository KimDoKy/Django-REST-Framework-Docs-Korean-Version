<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Throttling - Django Rest Framework Docs Korean version</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Throttling";
    var mkdocs_page_input_path = "Throttling.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Django Rest Framework Docs Korean version</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Requests/">Requests</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Responses/">Responses</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Views/">Views</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Generic_views/">Generic views</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../ViewSets/">Viewsets</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Routers/">Routers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Parsers/">Parsers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Renderers/">Renderers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Serializers/">Serializers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Serializer_fields/">Serializer fields</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Serializer_relations/">Serializer relations</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Validators/">Validators</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Authentication/">Authentication</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Permissions/">Permissions</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Throttling</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#django-rest-framework-throttling">Django REST Framework - Throttling</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#throttling">Throttling (제한)</a></li>
        
            <li><a class="toctree-l3" href="#api-reference">API Reference</a></li>
        
            <li><a class="toctree-l3" href="#custom-throttles">Custom throttles</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Filtering/">Filtering</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Pagination/">Pagination</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Versioning/">Versioning</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Content_negotiation/">Content negotiation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Metadata/">Metadata</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Schemas/">Schemas</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Format_suffixes/">Format suffixes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Returning_URLs/">Returning URLs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Exceptions/">Exceptions</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Status_Codes/">Status codes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Testing/">Testing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../Settings/">Settings</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Django Rest Framework Docs Korean version</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Throttling</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="django-rest-framework-throttling">Django REST Framework - Throttling</h1>
<hr />
<p><em>"HTTP/1.1 420 Enhance Your Calm"</em>  </p>
<p><em>Twitter API rate limiting response</em></p>
<hr />
<h2 id="throttling">Throttling (제한)</h2>
<p>Throttling은 request가 승인되어야하는지 여부를 결정한다는 점에서 permissions와 유사합니다. Throttling은 임시상태를 나타내며 클라이언트가 API에 대해 수행 할 수 있는 request 빈도수를 제어하는데 사용됩니다.<br />
permissions과 마찬가지로, 여러 Throttle을 사용할 수 있습니다. API에는 인증되지 않은 요청에 대해 제한적으로 Throttle과 인증 된 요청에 대한 제한적인 Throttle이 있을 수 있습니다.<br />
특정 서비스가 특히 리소스를 잡아먹기 때문에 API의 다양한 부분에 다른 제약을 부과해야하는 경우, 여러 throttle을 사용하는 다른 시나리오가 있습니다.<br />
버스트 빈도수 제한와  지속적인 빈도수 제한을 동시에 적용하려는 경우, 여러 throttle을 사용할 수 있습니다. 예를 들어, 분당 최대 60개의 요청과 하루에 1000개의 요청으로 사용자를 제한 할 수 있습니다.<br />
throttle은 반드시 rate 제한 요청을 참조하는 것은 아닙니다. 예를 들어, 스토리지 서비스는 대역폭에 대해 조정해야 할 수고 있으며, 유료 데이터 서비스는 액서스되는 특정 레코드 수에 대해 조정할 수 있습니다.</p>
<h3 id="how-throttling-is-determined">How throttling is determined</h3>
<p>사용 권한 및 인증과 마찬가지로 REST 프레임워크의 Throttling은 항상 클래스 목록으로 정의됩니다.<br />
뷰의 본문을 실행하기 전에 list의 각 throttle이 점검됩니다. throttle 확인이 실패하면 <code>exceptions.Throttled</code>예외가 발생하고, 뷰 본문은 실행되지 않습니다.</p>
<h3 id="setting-the-throttling-policy">Setting the throttling policy</h3>
<p>기본 throttling 정책은 <code>DEFAULT_THROTTLE_CLASSES</code>와 <code>DEFAULT_THROTTLE_RATES</code> 설정을 사용하여 전역으로 설정할 수 있습니다. 예를 들면.</p>
<pre><code class="python">REST_FRAMEWORK = {
    'DEFAULT_THROTTLE_CLASSES': (
        'rest_framework.throttling.AnonRateThrottle',
        'rest_framework.throttling.UserRateThrottle'
    ),
    'DEFAULT_THROTTLE_RATES': {
        'anon': '100/day',
        'user': '1000/day'
    }
}
</code></pre>

<p><code>DEFAULT_THROTTLE_RATES</code>에 사용 된 rate에는 throttle 기간으로 <code>second</code>, <code>minute</code>, <code>hour</code>, <code>day</code>이 포함 될 수 있습니다.<br />
또한 APIView CBV를 사용하여 뷰 단위 또는 뷰 단위별 조절 정책을 설정할 수 있습니다.</p>
<pre><code class="python">from rest_framework.response import Response
from rest_framework.throttling import UserRateThrottle
from rest_framework.views import APIView

class ExampleView(APIView):
    throttle_classes = (UserRateThrottle,)

    def get(self, request, format=None):
        content = {
            'status': 'request was permitted'
        }
        return Response(content)
</code></pre>

<p>또는 FBV와 함께 <code>@api_view</code>데코레이터를 사용하는 경우</p>
<pre><code class="python">@api_view(['GET'])
@throttle_classes([UserRateThrottle])
def example_view(request, format=None):
    content = {
        'status': 'request was permitted'
    }
    return Response(content)
</code></pre>

<h3 id="how-clients-are-identified">How clients are identified(클라이언트 식별 방법)</h3>
<p><code>X-Forwarded_For</code>와 <code>Remote-Addr</code> HTTP 헤더는 throttling을 위해 클라이언트  IP주소를 고유하게 식별하는데 사용됩니다.<br />
<code>X-Forwarded_For</code>헤더가 있으면 사용되고, 없으면 <code>Remote-Addr</code> 헤더 값이 사용됩니다.<br />
고유한 클라이언트 IP주소를 엄격하게 식별해야하는 경우, 우선 <code>NUM-PROXIES</code>설정을 하여 API가 실행되는 응용 프로그램 프록시의 수를 구성해야 합니다. 이 설정은 0 이상의 정수이어야 합니다. 0 이 아닌 값으로 설정된 경우,  클라이언트 IP는 응용 프로그램 프록시 IP 주소가 먼저 제외되면 <code>X-Forwarded-For</code> 헤더의 마지막 IP 주소로 식별됩니다. 0 으로 설정하면 <code>Remote-Addr</code>헤더가 항상 식별 IP주소로 사용됩니다.<br />
<code>NUM_PROXIES</code>설정을 구성하면 고유한 <code>NAT'd</code> 게이트웨이 뒤에 있는 모든 클라이언트가 단일 클라이언트로 처리 된다는 것을 이해하는 것이 중요합니다.<br />
<code>X-Forwarded-For</code>헤더의 작동 방식 및 원격 클라이언트 IP 식별 방법에 대한 자세한 내용은 <a href="http://oxpedia.org/wiki/index.php?title=AppSuite:Grizzly#Multiple_Proxies_in_front_of_the_cluster">여기</a>를 참조하세요.</p>
<h3 id="setting-up-the-cache">Setting up the cache</h3>
<p>REST 프레임워크가 제공하는 throttle 클래스는 Django의 캐시 백엔드를 사용합니다. 적절한 <a href="https://docs.djangoproject.com/en/1.10/ref/settings/#caches">캐시 설정</a>을 지정했는지 확인해야합니다. <code>LocMemCache</code>백엔드의 기본값은 간단한 설정으로 괜찮습니다. 자세한 내용은 <a href="https://docs.djangoproject.com/en/1.10/topics/cache/#setting-up-the-cache">cache documentation</a>을 참조하세요.<br />
<code>default</code>가 아닌 캐시를 사용해야하는 경우, custom throttle 클래스를 만들고 캐시 속성을 설정하면 됩니다. 예를 들어:</p>
<pre><code class="python">class CustomAnonRateThrottle(AnonRateThrottle):
    cache = get_cache('alternate')
</code></pre>

<p><code>DEFAULT_THROTTLE_CLASSES</code> 설정 키 또는 <code>throttle_classes</code> 뷰 속성을 사용하여 custom throttle 클래스를 기억해야만 합니다.</p>
<h2 id="api-reference">API Reference</h2>
<h3 id="anonratethrottle">AnonRateThrottle</h3>
<p><code>AnonRateThrottle</code>은 인증되지 않은 사용자만 차단합니다. 들어오는 request의 IP 주소는 제한할 고유 키를 생성하는데 사용됩니다.<br />
허용 된 request 등급은 다음 중 하나(선호도순)로 결정됩니다.</p>
<ul>
<li>클래스의 <code>rate</code> property는 <code>AnonRateThrottle</code>을 오버라이드하고 property를 설정하여 제공 될 수 있다.</li>
<li><code>DEFAULT_THROTTLE_RATES ['anon']</code> 설정입니다.  </li>
</ul>
<p><code>AnonRateThrottle</code>는 알 수 없는 출처에서의 request의 빈도수를 제한하려는 경우에 적합합니다.</p>
<h3 id="userratethrottle">UserRateThrottle</h3>
<p><code>UserRateThrottle</code>은 API를 통해 주어진 request rate로 사용자를 제한합니다. user ID는 제한할 고유 키를 생성하는데 사용됩니다. 인증되지 않은 request는 들어오는 request의  IP 주소에 고유한 제한 키를 다시 생성하여 걸러냅니다.<br />
허용 된 request rate는 다음 중 하나(선호도 순)로 결정됩니다.  </p>
<ul>
<li>클래스의 <code>rate</code>속성은 <code>UserRateThrottle</code>을 오버라이드하고 property를 설정하여 제공 될 수 있습니다.</li>
<li><code>DEFAULT_THROTTLE_RATES ['anon']</code> 설정입니다.  </li>
</ul>
<p>API에는 동시에 여러 <code>UserRAteThrottles</code>이 있을 수 있습니다. 이렇게 하려면 <code>UserRateThrottle</code>을 무시하고 각 클래스에 대해 고유한 <code>scope</code>(범위)를 설정하세요.<br />
예를 들어, 여러 사용자 throttle rate는 다음 클래스를 사용하여 구현할 수 있습니다.</p>
<pre><code class="python">class BurstRateThrottle(UserRateThrottle):
    scope = 'burst'

class SustainedRateThrottle(UserRateThrottle):
    scope = 'sustained'
</code></pre>

<p>...그리고 다음 설정입니다.</p>
<pre><code class="python">REST_FRAMEWORK = {
    'DEFAULT_THROTTLE_CLASSES': (
        'example.throttles.BurstRateThrottle',
        'example.throttles.SustainedRateThrottle'
    ),
    'DEFAULT_THROTTLE_RATES': {
        'burst': '60/min',
        'sustained': '1000/day'
    }
}
</code></pre>

<p><code>UserRateThrottle</code>은 사용자별로 간단한 전역 rate를 원할 때 적합합니다.</p>
<h3 id="scopedratethrottle">ScopedRateThrottle</h3>
<p><code>ScopeRateThrottle</code>클래스를 사용하여 API의 특정 부분에 대한 액서스를 제한 할 수 있습니다. 이 throttle은 액서스되는 뷰에 <code>.throttle_scope</code>속성이 포함 된 경우에만 적용됩니다. 고유한 throttle 키는 request의 "scope"를 고유한 user ID 또는 IP 주소와 연결하여 형성합니다.<br />
허용 된 request rate는 request "scope"의 키를 사용하여 <code>DEFAULT_THROTTLE_RATES</code>설정에 의해 결정됩니다.<br />
예를 들어, 다음의 뷰가 주어진 경우...</p>
<pre><code class="python">class ContactListView(APIView):
    throttle_scope = 'contacts'
    ...

class ContactDetailView(APIView):
    throttle_scope = 'contacts'
    ...

class UploadView(APIView):
    throttle_scope = 'uploads'
    ...
</code></pre>

<p>...그리고 다음 설정입니다.</p>
<pre><code class="python">REST_FRAMEWORK = {
    'DEFAULT_THROTTLE_CLASSES': (
        'rest_framework.throttling.ScopedRateThrottle',
    ),
    'DEFAULT_THROTTLE_RATES': {
        'contacts': '1000/day',
        'uploads': '20/day'
    }
}
</code></pre>

<p><code>ContactListView</code> 또는 <code>ContactDetailView</code>에 대한 사용자 요청은 하루에 총 1000 개의 요청으로 제한됩니다. <code>UploadView</code>에 대한 사용자 요청은 하루에 20 건으로 제한됩니다.</p>
<h2 id="custom-throttles">Custom throttles</h2>
<p>custom throttle을 만들려면 <code>BaseThrottle</code>을 재정의하고 <code>.allow_request(self, request, view)</code>를 구현하십시오. 이 메소드는 요청을 허용해야하는 경우 <code>True</code>를 반환하고 그렇지 않으면 <code>False</code>를 반환해야합니다.<br />
선택적으로 <code>.wait()</code> 메서드를 재정의 할 수도 있습니다. 구현 된 경우 <code>.wait()</code>는 다음 요청을 시도하기 전에 기다리는 권장 시간(초)을 반환하거나 <code>None</code>을 반환해야합니다. <code>.wait()</code> 메서드는 <code>.allow_request()</code>가 이전에 <code>False</code>를 반환 한 경우에만 호출됩니다.<br />
<code>.wait()</code> 메서드가 구현되고 요청이 제한되면 <code>Retry-After</code> 헤더가 응답에 포함됩니다.</p>
<h3 id="example">Example</h3>
<p>다음은 10의 요청마다 1을 무작위로 조절하는 rate throttle의 예입니다.</p>
<pre><code class="python">import random

class RandomRateThrottle(throttling.BaseThrottle):
    def allow_request(self, request, view):
        return random.randint(1, 10) != 1
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Filtering/" class="btn btn-neutral float-right" title="Filtering">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Permissions/" class="btn btn-neutral" title="Permissions"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Permissions/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Filtering/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
